!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("react"));else if("function"==typeof define&&define.amd)define(["react"],e);else{var n=e("object"==typeof exports?require("react"):t.React);for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(this,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(1),h=i(u),c=function(t){function e(t){a(this,e);var n=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=n.child=h.default.Children.only(n.props.children),r=n.props.value||i.props.value;n.hasValue=!!n.props.value;var o=n.parseMask(n.props.mask);return n.mask=o.mask,n.permanents=o.permanents,n.lastEditablePos=o.lastEditablePos,n.maskCharacter=n.props.maskCharacter,n.mask&&(n.props.alwaysShowMask||r)&&(r=n.formatValue(r)),n.state={child:i,value:r},n.onPaste=n.onPaste.bind(n),n.onBlur=n.onBlur.bind(n),n.onChange=n.onChange.bind(n),n.onFocus=n.onFocus.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.onKeyPress=n.onKeyPress.bind(n),n.onKeyUp=n.onKeyUp.bind(n),n.onCopy=n.onCopy.bind(n),n}return r(e,t),l(e,[{key:"setInputValue",value:function(t){var e=this.input;e.value=t}},{key:"setCaretToEnd",value:function(){var t=this.getFilledLength(),e=this.getRightEditablePosition(t);null!==e&&this.setCaretPosition(e)}},{key:"setCaretPosition",value:function(t){var n=e.requestAnimationFrame(),i=this.setSelection.bind(this,t,0);i(),n(i)}},{key:"getCaretPosition",value:function(){return this.getSelection().start}},{key:"setSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.input,i=t+e,a=0;"selectionStart"in n&&"selectionEnd"in n?(n.selectionStart=t,n.selectionEnd=i):(a=n.createTextRange(),a.collapse(!0),a.moveStart("character",t),a.moveEnd("character",i-t),a.select())}},{key:"getSelection",value:function(){var t=this.input,e=0,n=0;if("selectionStart"in t&&"selectionEnd"in t)e=t.selectionStart,n=t.selectionEnd;else{var i=document.selection.createRange();i.parentElement()===t&&(e=-i.moveStart("character",-t.value.length),n=-i.moveEnd("character",-t.value.length))}var a=n-e;return{start:e,end:n,length:a}}},{key:"getPrefix",value:function(){for(var t=this.mask,e="",n=0;n<t.length&&this.isPermanentChar(n);++n)e+=t[n];return e}},{key:"getEditablePosition",value:function(t){for(var e=this.mask,n=t;n<e.length;n++)if(!this.isPermanentChar(n))return n;return null}},{key:"getLeftEditablePosition",value:function(t){for(var e=t;e>=0;--e)if(!this.isPermanentChar(e))return e;return null}},{key:"getRightEditablePosition",value:function(t){for(var e=this.mask,n=t;n<e.length;++n)if(!this.isPermanentChar(n))return n;return null}},{key:"getFilledLength",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.value,e=void 0,n=void 0,i=this.maskCharacter;if(!i)return t.length;for(n=t.length-1;n>=0&&(e=t[n],this.isPermanentChar(n)||!this.isAllowedChar(e,n));--n);return++n||this.getPrefix().length}},{key:"getRawSubstrLength",value:function(t,e){for(var n=void 0,i=this.mask,a=e,s=t.split("");a<i.length&&s.length;)this.isPermanentChar(a)&&i[a]!==s[0]?++a:(n=s.shift(),this.isAllowedChar(n,a,!0)&&++a);return a-e}},{key:"getInputValue",value:function(){var t=this.input,e=this.valueDescriptor,n=void 0;return n=e?e.get.call(t):t.value}},{key:"componentWillMount",value:function(){var t=this.mask,e=this.state.value;t&&e&&this.setState({value:e})}},{key:"componentDidMount",value:function(){this.isAndroidBrowser=e.isAndroidBrowser(),this.isWindowsPhoneBrowser=e.isWindowsPhoneBrowser()}},{key:"onPaste",value:function(t){if(this.isAndroidBrowser)return this.pasteSelection=this.getSelection(),void this.setInputValue("");var e=void 0;if(window.clipboardData&&window.clipboardData.getData?e=window.clipboardData.getData("Text"):t.clipboardData&&t.clipboardData.getData&&(e=t.clipboardData.getData("text/plain")),e){var n=this.state.value,i=this.getSelection();this.pasteText(n,e,i,t)}t.preventDefault()}},{key:"onCopy",value:function(t){var e=this.getInputValue();e=e.substr(0,this.getFilledLength()),t.clipboardData.setData("text/plain",e),t.preventDefault()}},{key:"onKeyDown",value:function(t){this.input=t.target;var e=t.key,n=t.target.value,i=!1,a=this.getCaretPosition();switch(e){case"Backspace":case"Delete":var s=this.getPrefix(),r="Delete"===e,o=this.getSelection();if(o.length)n=this.clearRange(n,o.start,o.length);else if(a<s.length||!r&&a===s.length)a=s.length,i=!0;else{var l=r?this.getRightEditablePosition(a):this.getLeftEditablePosition(a-1);null!==l&&(n=this.clearRange(n,l,1),a=l)}}if(n!==this.state.value&&(this.setInputValue(n),this.setState({value:this.hasValue?this.state.value:n}),i=!0,"input"!==this.child.type.name)){var u=new Event("input",{bubbles:!0});this.input.dispatchEvent(u)}i&&(t.preventDefault(),this.setCaretPosition(a))}},{key:"onKeyPress",value:function(t){t.persist();var e=t.key;if(this.input=t.target,"Enter"!==e&&!t.ctrlKey&&!t.metaKey){if("input"!==this.child.type.name){var n=new Event("input",{bubbles:!0});this.input.dispatchEvent(n)}if(!this.isWindowsPhoneBrowser){var i=this.getCaretPosition(),a=this.state.value,s=this.mask,r=this.lastEditablePos,o=this.getPrefix(),l=this.getSelection();if(this.isPermanentChar(i)&&s[i]===e)a=this.insertRawSubstr(a,e,i),++i;else{var u=this.getRightEditablePosition(i);null!==u&&this.isAllowedChar(e,u)&&(a=this.clearRange(a,l.start,l.length),a=this.insertRawSubstr(a,e,u),i=u+1)}a!==this.state.value&&(this.setInputValue(a),this.setState({value:this.hasValue?this.state.value:a}),"function"==typeof this.props.onChange&&this.props.onChange(t)),t.preventDefault(),i<r&&i>o.length&&(i=this.getRightEditablePosition(i)),this.setCaretPosition(i)}}}},{key:"onKeyUp",value:function(t){this.setState({value:t.target.value})}},{key:"onBlur",value:function(t){if(!this.props.alwaysShowMask&&this.isEmpty()){var e="",n=e!==this.getInputValue();n&&this.setInputValue(e),this.setState({value:this.hasValue?this.state.value:""})}"function"==typeof this.props.onBlur&&this.props.onBlur(t)}},{key:"getClearedValue",value:function(t,e,n,i,a){var s=this.clearRange(t,n,i);return this.insertRawSubstr(s,e,a)}},{key:"formatEnteredSubstr",value:function(t,e){var n=this.lastEditablePos,i=this.mask,a=t.length-e.length,s=this.getSelection(),r=s.end-a,o=i.length-r,l=t.substr(r,a),u=this.getPrefix(),h=s.end,c=void 0;return h=r<n&&(1!==a||l!==i[r])?this.getRightEditablePosition(r):r,t=t.substr(0,r)+t.substr(r+a),1!==a||h>=u.length&&h<n?(c=this.getClearedValue(t,l,r,o,h),h=this.getFilledLength(c)):h<n&&h++,{inputValue:t,caretPosition:h}}},{key:"formatRemovedSubstr",value:function(t,e){var n=this.mask,i=this.maskCharacter,a=this.getSelection(),s=this.getPrefix(),r=n.length-t.length,o=t.substr(0,a.end),l=o===e.substr(0,a.end),u=this.clearRange(e,a.end,r),h=a.end;return i&&(t=this.insertRawSubstr(u,o,0)),l?h<s.length&&(h=s.length):(u=this.getClearedValue(u,o,a.end,n.length-a.end,0),h=this.getFilledLength(u)),{inputValue:t,caretPosition:h}}},{key:"onChange",value:function(t){this.input=t.target;var e=this.pasteSelection,n=this.state.value,i=this.input.value;if(e)return this.pasteSelection=null,void this.pasteText(n,i,e,t);var a=void 0,s=void 0;a=i.length<n.length?this.formatRemovedSubstr(i,n):this.formatEnteredSubstr(i,n),i=a.inputValue,s=a.caretPosition,i=this.formatValue(i),this.setState({value:this.hasValue?this.state.value:i}),"function"==typeof this.props.onChange&&this.props.onChange(t),this.setCaretPosition(s)}},{key:"onFocus",value:function(t){if(this.input=t.target,this.state.value)this.getFilledLength()<this.mask.length&&this.setCaretToEnd();else{var e=this.getPrefix(),n=this.formatValue(e),i=this.formatValue(n);this.setState({value:this.hasValue?this.state.value:i},this.setCaretToEnd)}"function"==typeof this.props.onFocus&&this.props.onFocus(t)}},{key:"isAllowedChar",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.mask,a=this.maskCharacter,s=i[e],r=this.props.formatCharacters[s];return this.isPermanentChar(e)?s===t:new RegExp(r).test(t)||n&&t===a}},{key:"isPermanentChar",value:function(t){return this.permanents.indexOf(t)!==-1}},{key:"isFilled",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.value;return this.getFilledLength(t)===this.mask.length}},{key:"isEmpty",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.value;return!e.split("").some(function(e,n){return!t.isPermanentChar(n)&&t.isAllowedChar(e,n)})}},{key:"clearRange",value:function(t,e,n){var i=this,a=e+n,s=this.maskCharacter,r=this.mask;if(!s){var l=function(){var n=i.getPrefix();return t=t.split("").filter(function(t,i){return i<n.length||i<e||i>=a}).join(""),{v:i.formatValue(t)}}();if("object"===("undefined"==typeof l?"undefined":o(l)))return l.v}return t.split("").map(function(t,n){return n<e||n>=a?t:i.isPermanentChar(n)?r[n]:s}).join("")}},{key:"formatValue",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.maskCharacter,i=this.mask;if(!n){var a=this.getPrefix();e=this.insertRawSubstr("",e,0);for(var s=e.length-1;e.length>a.length&&this.isPermanentChar(s);)e=e.slice(0,s),s=e.length-1;return e.length<a.length&&(e=a),e}if(e){var r=this.formatValue();return this.insertRawSubstr(r,e,0)}return e.split("").concat(new Array(i.length-e.length).fill(null)).map(function(e,a){return t.isAllowedChar(e,a)?e:t.isPermanentChar(a)?i[a]:n}).join("")}},{key:"insertRawSubstr",value:function(t,n,i){var a=this.mask,s=this.maskCharacter,r=this.isFilled(t),o=this.getPrefix();n=n.split(""),!s&&i>t.length&&(t+=a.slice(t.length,i));for(var l=i;l<a.length&&n.length;){var u=this.isPermanentChar(l);if(u&&a[l]!==n[0])!s&&l>=t.length?t+=a[l]:s&&u&&n[0]===s&&n.shift(),++l;else{var h=n.shift();this.isAllowedChar(h,l,!0)&&(l<t.length?t=s||r||l<o.length?e.replaceSubstr(t,h,l):this.formatValue(t.substr(0,l)+h+t.substr(l)):s||(t+=h),++l)}}return t}},{key:"parseMask",value:function(t){var e=this,n=[],i=!1,a="",s=null;return t.split("").forEach(function(t){i=!i&&"\\"===t,i||!e.props.formatCharacters.hasOwnProperty(t)?n.push(a.length):s=a.length+1,a+=t}),{mask:a,permanents:n,lastEditablePos:s}}},{key:"pasteText",value:function(t,e,n,i){var a=n.start;n.length&&(t=this.clearRange(t,a,n.length));var s=this.getRawSubstrLength(e,a);t=this.insertRawSubstr(t,e,a),a+=s,a=this.getRightEditablePosition(a)||a,t!==this.getInputValue()&&(i&&this.setInputValue(t),this.setState({value:this.hasValue?this.state.value:t}),i&&"function"==typeof this.props.onChange&&this.props.onChange(i)),this.setCaretPosition(a)}},{key:"render",value:function(){var t=this,e=this.child.props.value,n=["onFocus","onBlur","onChange","onKeyDown","onKeyPress","onKeyUp","onPaste","onCopy"],i={value:e};return n.forEach(function(e){i[e]=t[e]}),null!==i.value&&void 0!==i.value&&(i.value=this.state.value),this.child=h.default.cloneElement(this.child,i),h.default.createElement("div",{className:"masked"},this.child)}}],[{key:"replaceSubstr",value:function(t,e,n){return t.slice(0,n)+e+t.slice(n+e.length)}},{key:"isAndroidBrowser",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=new RegExp("windows","i"),n=new RegExp("firefox","i"),i=new RegExp("android","i"),a=navigator.userAgent;return!e.test(a)&&t===n.test(a)&&i.test(a)}},{key:"isWindowsPhoneBrowser",value:function(){var t=new RegExp("windows","i"),e=new RegExp("phone","i"),n=navigator.userAgent;return t.test(n)&&e.test(n)}},{key:"requestAnimationFrame",value:function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,0)}}}]),e}(h.default.Component);c.propTypes={children:h.default.PropTypes.object,mask:h.default.PropTypes.string,maskCharacter:h.default.PropTypes.string,formatCharacters:h.default.PropTypes.object,alwaysShowMask:h.default.PropTypes.bool,i18n:h.default.PropTypes.string,value:h.default.PropTypes.string,onChange:h.default.PropTypes.func,onBlur:h.default.PropTypes.func,onFocus:h.default.PropTypes.func},c.defaultProps={maskCharacter:"_",formatCharacters:{9:"[0-9]",a:"^[A-Za-z]$",A:"^[A-Z]$","*":"[A-Za-z0-9]"},alwaysShowMask:!0},e.default=c},function(e,n){e.exports=t}])});